name: DUBBED-DHAMAAL-V110-AUTO-PILOT

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 9600

    steps:
      - name: 1. Titan Core & AI Setup
        run: |
          Stop-Service -Name wuauserv, SysMain -Force
          pip install pyautogui psutil opencv-python numpy
          choco install googlechrome --accept-license -y

      - name: 2. Tailscale Secure Tunnel
        continue-on-error: true 
        run: |
          $tsUrl = "https://pkgs.tailscale.com/stable/tailscale-setup-1.82.0-amd64.msi"
          Invoke-WebRequest -Uri $tsUrl -OutFile "ts.msi"
          Start-Process msiexec.exe -ArgumentList "/i", "ts.msi", "/quiet", "/norestart" -Wait
          & "$env:ProgramFiles\Tailscale\tailscale.exe" up --hostname="titan-final-boss" --accept-routes --force-reauth
          Start-Sleep -Seconds 25
          & "$env:ProgramFiles\Tailscale\tailscale.exe" ip -4

      - name: 3. Create RDP & Ultimate Desktop Script
        run: |
          $password = "Admin@Watch786"
          $securePass = ConvertTo-SecureString $password -AsPlainText -Force
          if (!(Get-LocalUser -Name "RDP" -ErrorAction SilentlyContinue)) {
              New-LocalUser -Name "RDP" -Password $securePass -AccountNeverExpires
              Add-LocalGroupMember -Group "Administrators" -Member "RDP"
          }
          
          # Master Script with FIXED LINKS and GUEST MODE
          $masterScript = @"
          import os
          import time
          import subprocess
          import pyautogui
          import random
          import psutil

          # --- FIXED LINKS ADDED BY TITAN ---
          links = [
              "https://youtu.be/oiyYa3IL2Rc?si=LnzHB2SnxLvotRp-",
              "https://youtu.be/OXuTuHQqB7s?si=hsLjg-WN4Kddl2en",
              "https://youtu.be/K9ihEWJn4Go?si=VMP02dzeGwZtH_G0",
              "https://youtu.be/z25lo2mogbk?si=RDQn25eKVGl6u8Dy",
              "https://youtu.be/ZkJlQ_q7x5Q?si=5vafU9AuYNTZcp5E"
          ]
          
          chrome_path = r'C:\Program Files\Google\Chrome\Application\chrome.exe'
          
          print("Launching 25 Profiles in Invisible Stealth Mode...")
          for i in range(25): # 25 Best Features / Profiles
              url = links[i % len(links)]
              profile = f'--user-data-dir=C:\\Profiles\\Titan_{i}'
              flags = [
                  chrome_path, profile, 
                  '--guest',                # No Login Required
                  '--no-first-run',         # Skip Welcome Screen
                  '--no-sandbox', 
                  '--mute-audio', 
                  '--disable-blink-features=AutomationControlled',
                  '--window-size=500,350',  # Optimized Size
                  url
              ]
              subprocess.Popen(flags)
              time.sleep(3)

          # --- AUTOMOTIVE SYSTEM LOGIC ---
          while True:
              try:
                  # Feature: Smart Window Focus
                  pyautogui.keyDown('alt')
                  pyautogui.press('tab')
                  pyautogui.keyUp('alt')
                  time.sleep(2)

                  # Feature: Organic Click & Play
                  pyautogui.click(random.randint(200, 400), random.randint(150, 300))
                  pyautogui.press('k') # Force Play Toggle
                  
                  # Feature: Auto-Healing (Refresh if 0% Network)
                  net_before = psutil.net_io_counters().bytes_recv
                  time.sleep(15)
                  if psutil.net_io_counters().bytes_recv == net_before:
                      print("Network Stuck! Auto-Refreshing...")
                      pyautogui.press('f5')
                  
                  # Feature: Human-like Scrolling
                  pyautogui.scroll(random.randint(-200, 200))
                  pyautogui.press('shift')
                  
                  print(f"Titan Status: Watching... {time.strftime('%H:%M:%S')}")
              except:
                  pass
          "@
          $masterScript | Out-File -FilePath "C:\Users\Public\Desktop\RUN_TITAN_ULTIMATE.py" -Encoding ascii

      - name: 4. Final Success Confirmation
        run: |
          Write-Host "############################################"
          Write-Host "STATUS: READY TO GO!"
          Write-Host "1. Connect RDP (User: RDP | Pass: Admin@Watch786)"
          Write-Host "2. Run 'RUN_TITAN_ULTIMATE.py' on Desktop."
          Write-Host "############################################"
          Start-Sleep -Seconds 9000
