name: TITAN-EMPIRE-V121-FINAL

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 9600

    steps:
      - name: 1. Core Setup
        run: |
          Stop-Service -Name wuauserv, SysMain -Force
          pip install psutil pyautogui --quiet
          choco install googlechrome --accept-license -y

      - name: 2. Tailscale Tunnel
        continue-on-error: true 
        run: |
          $tsUrl = "https://pkgs.tailscale.com/stable/tailscale-setup-1.82.0-amd64.msi"
          Invoke-WebRequest -Uri $tsUrl -OutFile "ts.msi"
          Start-Process msiexec.exe -ArgumentList "/i", "ts.msi", "/quiet", "/norestart" -Wait
          & "$env:ProgramFiles\Tailscale\tailscale.exe" up --hostname="titan-empire" --accept-routes --force-reauth
          Start-Sleep -Seconds 20

      - name: 3. Create RDP & Mega-Automatic Script
        run: |
          $password = "Admin@Watch786"
          $securePass = ConvertTo-SecureString $password -AsPlainText -Force
          if (!(Get-LocalUser -Name "RDP" -ErrorAction SilentlyContinue)) {
              New-LocalUser -Name "RDP" -Password $securePass -AccountNeverExpires
              Add-LocalGroupMember -Group "Administrators" -Member "RDP"
          }

          $empireScript = @"
          import os
          import time
          import subprocess
          import psutil
          import shutil
          import random

          # Aapke 5 Links (Divided into 25 profiles)
          links = [
              "https://youtu.be/oiyYa3IL2Rc?si=LnzHB2SnxLvotRp-",
              "https://youtu.be/OXuTuHQqB7s?si=hsLjg-WN4Kddl2en",
              "https://youtu.be/K9ihEWJn4Go?si=VMP02dzeGwZtH_G0",
              "https://youtu.be/z25lo2mogbk?si=RDQn25eKVGl6u8Dy",
              "https://youtu.be/ZkJlQ_q7x5Q?si=5vafU9AuYNTZcp5E"
          ]
          
          chrome_path = r'C:\Program Files\Google\Chrome\Application\chrome.exe'
          profile_base = r'C:\Users\Public\TitanProfiles'

          def system_flush():
              print("[AI] Flushing System RAM & Old Cache...")
              for proc in psutil.process_iter(['name']):
                  if proc.info['name'] == 'chrome.exe':
                      try: proc.kill()
                      except: pass
              time.sleep(5)
              if os.path.exists(profile_base):
                  try: shutil.rmtree(profile_base)
                  except: pass
              os.makedirs(profile_base, exist_ok=True)

          def start_empire():
              print("[AI] Generating 25 Secure Profiles with VPN & 144p Shield...")
              for i in range(25):
                  # Har link 5 baar repeat hoga (5*5=25)
                  url = links[i % len(links)]
                  p_dir = os.path.join(profile_base, f'Empire_{i}')
                  
                  flags = [
                      chrome_path, 
                      f'--user-data-dir={p_dir}', 
                      '--no-first-run', 
                      '--mute-audio', 
                      '--window-size=450,350',
                      '--force-device-scale-factor=0.4', # Extreme 144p Mode
                      '--disable-blink-features=AutomationControlled',
                      '--disable-infobars',
                      '--no-sandbox',
                      url
                  ]
                  subprocess.Popen(flags)
                  print(f"Profile {i+1} Live: Link { (i%5)+1 }")
                  time.sleep(4) # CPU Stability Delay

          while True:
              system_flush()
              start_empire()
              print("[TIMER] 4-Hour Session Started. Auto-Reset active.")
              time.sleep(14400) # 4 Hours Cycle
          "@
          
          # Desktop Files
          $empireScript | Out-File -FilePath "C:\Users\Public\Desktop\TITAN_EMPIRE.py" -Encoding ascii
          "@echo off`npython C:\Users\Public\Desktop\TITAN_EMPIRE.py`npause" | Out-File -FilePath "C:\Users\Public\Desktop\START_EMPIRE.bat" -Encoding ascii

      - name: 4. Final Instruction
        run: |
          Write-Host "############################################"
          Write-Host "V121 EMPIRE SYSTEM IS READY!"
          Write-Host "1. Login RDP (Admin@Watch786)"
          Write-Host "2. START_EMPIRE.bat par Double-Click karein."
          Write-Host "3. 25 Profiles automatic links ke saath khulengi."
          Write-Host "############################################"
          Start-Sleep -Seconds 9000
